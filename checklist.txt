Ada83 Compiler — ACATS C-Series Progress Checklist
====================================================

Compiler: ada83.c (~22,600 lines, single-file Ada 83 → LLVM IR)
Target:   ACATS c-series tests (ANSI/MIL-STD-1815A conformance)
Branch:   claude/refactor-ada83-c-mfxAj

READ GNAT LLVM SOURCES FOR HELP DURING DEVELOPMENT

=== COMPLETED (this session) ===

1. [x] Record component default expressions (RM 3.7)
   - Added default_expr field to Component_Info
   - Store defaults when parsing record type definitions
   - Generate initialization code for records without explicit init

2. [x] T'VAL range checking (RM 3.5.5)
   - VAL now raises CONSTRAINT_ERROR if n outside valid positions
   - Works for enumeration types (0..count-1) and scalar types

3. [x] Membership test for type names (M IN DT)
   - Fixed evaluation of right operand when it's a type name
   - Type bounds now properly extracted for range check

4. [x] Constrained → unconstrained array parameter passing (RM 6.4.1)
   - When passing constrained array to unconstrained formal, build fat pointer
   - Extract bounds from constrained type's Type_Info
   - Uses Emit_Fat_Pointer(cg, data_ptr, lo, hi)

5. [x] Aggregate type propagation in membership tests (RM 4.4)
   - For AGG IN T: resolve T first, propagate type to aggregate
   - Fixed: resolve right operand (type name) before left aggregate
   - Enables aggregate components to be properly typed

6. [x] Derived type operation inheritance (RM 3.4) - GNAT-style
   - Emit direct calls to parent operation instead of wrappers
   - Added parent_operation field to Symbol struct
   - Derive_Subprograms creates symbols with return/param type substitution
   - Code gen: call_target = sym->parent_operation ?: sym
   - Identical representation in Ada 83 = no conversion needed
   - c34 tests: 0 → 3 passing (c34001a, c34009a, c34009g)

7. [x] Function result indexing (func(...)(i))
   - Fixed: CREATE(X)(2) was treated as second function call
   - Added prefix_is_call_target check in Resolve_Apply
   - Complex prefix expressions now route to array indexing

=== IN PROGRESS ===

Element concatenation (C & 3.0):
  - Scalar & Scalar should produce array when in context
  - Required for c34005a and similar tests
  - Need to infer array type from context

=== REMAINING ERROR CATEGORIES (by impact) ===

Category                                   | Count | Groups
-------------------------------------------|-------|--------
Derived ops inheritance (wrappers)         |  ~40  | c34
Incompatible types for comparison          |  ~43  | c3x, c4x
Undefined identifier C1/DISC              |  ~31  | c3x
Unsupported expression kind (NK_RANGE)     |  ~25  | c4x
Type mismatch in assignment                |  ~19  | c3x, c4x
Discriminant constraint checking           |  ~20  | c37

=== TEST RESULTS (latest) ===

Group | Pass | Total | Rate  | Change
------|------|-------|-------|--------
c34   |    3 |    67 |   4%  | +3 (GNAT-style derived ops)
c35   |   47 |   120 |  39%  | stable
c37   |    9 |    68 |  13%  | stable
c45   |   28 |   108 |  25%  | stable
ALL C |  239 | 1979  |  12%  | (full C-series)

=== NOTES ===

- Coding style: Haskell-like C99, tight code-golfing, Literate Programming
- Ada-like full names, sparse but thoughtful comments
- Reference: /home/user/Ada83/reference/gnat/ (GNAT LLVM source)
- Computation model: all scalars in i64 width; narrow only at store/param
- Test harness: bash test.sh q <group>
